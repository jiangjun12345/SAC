<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE sqlMap
	PUBLIC "-//iBATIS.com//DTD SQL Map 2.0//EN"
	"http://www.ibatis.com/dtd/sql-map-2.dtd">

<sqlMap>
	<!-- 原始交易resultMap -->
	<resultMap id="SacOtrxInfo" class="net.easipay.cbp.model.SacOtrxInfo">
		<result property="id" column="id" />
		<result property="cusBillNo" column="cus_bill_no" />
		<result property="platBillNo" column="plat_bill_no" />
		<result property="trxSerialNo" column="trx_serial_no" />
		<result property="otrxSerialNo" column="otrx_serial_no" />
		<result property="etrxSerialNo" column="etrx_serial_no" />
		<result property="trxState" column="trx_state" />
		<result property="craccCusCode" column="cracc_cus_code" />
		<result property="craccCusType" column="cracc_cus_type" />
		<result property="craccNo" column="cracc_no" />
		<result property="craccName" column="cracc_name" />
		<result property="craccNodeCode" column="cracc_node_code" />
		<result property="craccBankName" column="cracc_bank_name" />
		<result property="draccCusCode" column="dracc_cus_code" />
		<result property="draccCusType" column="dracc_cus_type" />
		<result property="draccNo" column="dracc_no" />
		<result property="draccName" column="dracc_name" />
		<result property="draccNodeCode" column="dracc_node_code" />
		<result property="draccBankName" column="dracc_bank_name" />
		<result property="payCurrency" column="pay_currency" />
		<result property="payAmount" column="pay_amount" />
		<result property="bussType" column="buss_type" />
		<result property="trxType" column="trx_type" />
		<result property="payWay" column="pay_way" />
		<result property="sacFlag" column="sac_flag" />
		<result property="innConFlag" column="inn_con_flag" />
		<result property="innConStatus" column="inn_con_status" />
		<result property="payconType" column="paycon_type" />
		<result property="chaConFlag" column="cha_con_flag" />
		<result property="chaConStatus" column="cha_con_status" />
		<result property="trxBatchNo" column="trx_batch_no" />
		<result property="updateTime" column="update_time" />
		<result property="createTime" column="create_time" />
		<result property="memo" column="memo" />
		<result property="trxErrDealType" column="trx_err_deal_type" />
		<result property="exRate" column="ex_rate" nullValue="0" />
		<result property="sacCurrency" column="sac_currency" />
		<result property="sacAmount" column="sac_amount" />
		<result property="craccCusName" column="cracc_cus_name" />
		<result property="draccCusName" column="dracc_cus_name" />
		<result property="reversalStatus" column="reversal_status" />
		<result property="accountStatus" column="account_status" />
		<result property="taxAmount" column="tax_amount" />
		<result property="transportExpenses" column="transport_expenses" />
	 	<result property="channelCost" column="channel_cost"/>
		<result property="cusCharge" column="cus_charge"/>
		<result property="trxSuccTime" column="trx_succ_time"/>
		<result property="craccCardId" column="cracc_card_id"/>
		<result property="draccCardId" column="dracc_card_id"/>
	</resultMap>

	<!-- 交易明细查询resultMap -->
	<resultMap id="SacOtrxInfo2" class="net.easipay.cbp.model.SacOtrxInfo">
		<result property="id" column="id" />
		<result property="cusBillNo" column="cus_bill_no" />
		<result property="platBillNo" column="plat_bill_no" />
		<result property="trxSerialNo" column="trx_serial_no" />
		<result property="otrxSerialNo" column="otrx_serial_no" />
		<result property="etrxSerialNo" column="etrx_serial_no" />
		<result property="trxState" column="trx_state" />
		<result property="craccCusCode" column="cracc_cus_code" />
		<result property="craccCusType" column="cracc_cus_type" />
		<result property="craccNo" column="cracc_no" />
		<result property="craccName" column="cracc_name" />
		<result property="craccNodeCode" column="cracc_node_code" />
		<result property="craccBankName" column="cracc_bank_name" />
		<result property="draccCusCode" column="dracc_cus_code" />
		<result property="draccCusType" column="dracc_cus_type" />
		<result property="draccNo" column="dracc_no" />
		<result property="draccName" column="dracc_name" />
		<result property="draccNodeCode" column="dracc_node_code" />
		<result property="draccBankName" column="dracc_bank_name" />
		<result property="payCurrency" column="pay_currency" />
		<result property="payAmount" column="pay_amount" />
		<result property="bussType" column="buss_type" />
		<result property="trxType" column="trx_type" />
		<result property="payWay" column="pay_way" />
		<result property="sacFlag" column="sac_flag" />
		<result property="innConFlag" column="inn_con_flag" />
		<result property="innConStatus" column="inn_con_status" />
		<result property="payconType" column="paycon_type" />
		<result property="chaConFlag" column="cha_con_flag" />
		<result property="chaConStatus" column="cha_con_status" />
		<result property="trxBatchNo" column="trx_batch_no" />
		<result property="updateTime" column="update_time" />
		<result property="createTime" column="create_time" />
		<result property="memo" column="memo" />
		<result property="trxErrDealType" column="trx_err_deal_type" />
		<result property="exRate" column="ex_rate" nullValue="0" />
		<result property="sacCurrency" column="sac_currency" />
		<result property="sacAmount" column="sac_amount" />
		<result property="craccCusName" column="cracc_cus_name" />
		<result property="draccCusName" column="dracc_cus_name" />
	 	<result property="channelCost" column="channel_cost"/>
		<result property="cusCharge" column="cus_charge"/>
		<result property="trxSuccTime" column="trx_succ_time"/>
	</resultMap>

	<!-- 购付汇resultMap -->
	<resultMap id="purchaseAndPay" class="net.easipay.cbp.model.SacOtrxInfo">
		<result property="trxTime" column="trx_time" />
		<result property="trxSerialNo" column="trx_serial_no" />
		<result property="trxType" column="trx_type" />
		<result property="draccNodeCode" column="cracc_node_code" />
		<result property="draccBankName" column="cracc_bank_name" />
		<result property="draccNo" column="dracc_no" />
		<result property="payCurrency" column="pay_currency" />
		<result property="payAmount" column="pay_amount" />
		<result property="exRate" column="ex_rate" nullValue="0" />
		<result property="sacCurrency" column="sac_currency" />
		<result property="sacAmount" column="sac_amount" />
		<result property="craccNodeCode" column="cracc_node_code" />
		<result property="craccBankName" column="cracc_bank_name" />
		<result property="craccNo" column="cracc_no" />
		<result property="draccCusCode" column="cus_no" />
		<result property="draccCusName" column="cus_name"/>
		<result property="trxBatchNo" column="trx_batch_no" />
		<result property="memo" column="counts" />
	</resultMap>

	<!-- 金额汇总resultMap -->
	<resultMap class="java.util.HashMap" id="AmountSum">
		<result property="payCurrency" column="pay_currency"/>
		<result property="payAmountSum" column="pay_amount_sum"/>
	</resultMap>

	<insert id="insertSacOtrxInfo" parameterClass="net.easipay.cbp.model.SacOtrxInfo">
		INSERT INTO SAC_OTRX_INFO (
		<dynamic prepend="">
			<isNotEmpty prepend="" property="id"> id  </isNotEmpty>
			<isNotEmpty prepend="," property="cusBillNo"> cus_bill_no  </isNotEmpty>
			<isNotEmpty prepend="," property="platBillNo"> plat_bill_no</isNotEmpty>
			<isNotEmpty prepend="," property="trxSerialNo"> trx_serial_no</isNotEmpty>
			<isNotEmpty prepend="," property="otrxSerialNo"> otrx_serial_no</isNotEmpty>
			<isNotEmpty prepend="," property="etrxSerialNo"> etrx_serial_no</isNotEmpty>
			<isNotEmpty prepend="," property="trxState"> trx_state  </isNotEmpty>
			<isNotEmpty prepend="," property="craccCusCode"> cracc_cus_code</isNotEmpty>
			<isNotEmpty prepend="," property="craccCusType"> cracc_cus_type</isNotEmpty>
			<!-- <isNotEmpty prepend="," property="craccIdentifyType"> cracc_identify_type</isNotEmpty> <isNotEmpty prepend="," property="craccIdentifyCode"> cracc_identify_code</isNotEmpty> -->
			<isNotEmpty prepend="," property="craccNo"> cracc_no  </isNotEmpty>
			<isNotEmpty prepend="," property="craccName"> cracc_name  </isNotEmpty>
			<isNotEmpty prepend="," property="craccNodeCode"> cracc_node_code</isNotEmpty>
			<isNotEmpty prepend="," property="craccBankName"> cracc_bank_name</isNotEmpty>
			<isNotEmpty prepend="," property="draccCusCode"> dracc_cus_code</isNotEmpty>
			<isNotEmpty prepend="," property="draccCusType"> dracc_cus_type</isNotEmpty>
			<!-- <isNotEmpty prepend="," property="draccIdentifyType"> dracc_identify_type</isNotEmpty> <isNotEmpty prepend="," property="draccIdentifyCode"> dracc_identify_code</isNotEmpty> -->
			<isNotEmpty prepend="," property="draccNo"> dracc_no  </isNotEmpty>
			<isNotEmpty prepend="," property="draccName"> dracc_name  </isNotEmpty>
			<isNotEmpty prepend="," property="draccNodeCode"> dracc_node_code</isNotEmpty>
			<isNotEmpty prepend="," property="draccBankName"> dracc_bank_name</isNotEmpty>
			<isNotEmpty prepend="," property="payCurrency"> pay_currency</isNotEmpty>
			<isNotEmpty prepend="," property="payAmount"> pay_amount  </isNotEmpty>
			<isNotEmpty prepend="," property="bussType"> buss_type  </isNotEmpty>
			<isNotEmpty prepend="," property="trxType"> trx_type  </isNotEmpty>
			<isNotEmpty prepend="," property="payWay"> pay_way  </isNotEmpty>
			<isNotEmpty prepend="," property="sacFlag"> sac_flag  </isNotEmpty>
			<isNotEmpty prepend="," property="innConFlag"> inn_con_flag</isNotEmpty>
			<isNotEmpty prepend="," property="innConStatus"> inn_con_status</isNotEmpty>
			<isNotEmpty prepend="," property="payconType"> paycon_type  </isNotEmpty>
			<isNotEmpty prepend="," property="chaConFlag"> cha_con_flag</isNotEmpty>
			<isNotEmpty prepend="," property="chaConStatus"> cha_con_status</isNotEmpty>
			<isNotEmpty prepend="," property="trxBatchNo"> trx_batch_no</isNotEmpty>
			<isNotEmpty prepend="," property="updateTime"> update_time  </isNotEmpty>
			<isNotEmpty prepend="," property="createTime"> create_time  </isNotEmpty>
			<isNotEmpty prepend="," property="memo"> memo  </isNotEmpty>
			<isNotEmpty prepend="," property="trxErrDealType"> trx_err_deal_type</isNotEmpty>
			<isNotEmpty prepend="," property="exRate"> ex_rate  </isNotEmpty>
			<isNotEmpty prepend="," property="sacCurrency"> sac_currency  </isNotEmpty>
			<isNotEmpty prepend="," property="sacAmount"> sac_amount  </isNotEmpty>
			<isNotEmpty prepend="," property="craccCardId"> cracc_card_id  </isNotEmpty>
			<isNotEmpty prepend="," property="draccCardId"> dracc_card_id  </isNotEmpty>
		</dynamic>
		) VALUES (
		<dynamic prepend="">
			<isNotEmpty prepend="," property="id"> #id#  </isNotEmpty>
			<isNotEmpty prepend="," property="cusBillNo"> #cusBillNo#  </isNotEmpty>
			<isNotEmpty prepend="," property="platBillNo"> #platBillNo#
			</isNotEmpty>
			<isNotEmpty prepend="," property="trxSerialNo"> #trxSerialNo#
			</isNotEmpty>
			<isNotEmpty prepend="," property="otrxSerialNo"> #otrxSerialNo#
			</isNotEmpty>
			<isNotEmpty prepend="," property="etrxSerialNo"> #etrxSerialNo#
			</isNotEmpty>
			<isNotEmpty prepend="," property="trxState"> #trxState#  </isNotEmpty>
			<isNotEmpty prepend="," property="craccCusCode"> #craccCusCode#
			</isNotEmpty>
			<isNotEmpty prepend="," property="craccCusType"> #craccCusType#
			</isNotEmpty>
			<!-- <isNotEmpty prepend="," property="craccIdentifyType"> #craccIdentifyType# </isNotEmpty> <isNotEmpty prepend="," property="craccIdentifyCode"> #craccIdentifyCode# </isNotEmpty> -->
			<isNotEmpty prepend="," property="craccNo"> #craccNo#  </isNotEmpty>
			<isNotEmpty prepend="," property="craccName"> #craccName#  </isNotEmpty>
			<isNotEmpty prepend="," property="craccNodeCode"> #craccNodeCode#
			</isNotEmpty>
			<isNotEmpty prepend="," property="craccBankName"> #craccBankName#
			</isNotEmpty>
			<isNotEmpty prepend="," property="draccCusCode"> #draccCusCode#
			</isNotEmpty>
			<isNotEmpty prepend="," property="draccCusType"> #draccCusType#
			</isNotEmpty>
			<!-- <isNotEmpty prepend="," property="draccIdentifyType"> #draccIdentifyType# </isNotEmpty> <isNotEmpty prepend="," property="draccIdentifyCode"> #draccIdentifyCode# </isNotEmpty> -->
			<isNotEmpty prepend="," property="draccNo"> #draccNo#  </isNotEmpty>
			<isNotEmpty prepend="," property="draccName"> #draccName#  </isNotEmpty>
			<isNotEmpty prepend="," property="draccNodeCode"> #draccNodeCode#
			</isNotEmpty>
			<isNotEmpty prepend="," property="draccBankName"> #draccBankName#
			</isNotEmpty>
			<isNotEmpty prepend="," property="payCurrency"> #payCurrency#
			</isNotEmpty>
			<isNotEmpty prepend="," property="payAmount"> #payAmount#  </isNotEmpty>
			<isNotEmpty prepend="," property="bussType"> #bussType#  </isNotEmpty>
			<isNotEmpty prepend="," property="trxType"> #trxType#  </isNotEmpty>
			<isNotEmpty prepend="," property="payWay"> #payWay#  </isNotEmpty>
			<isNotEmpty prepend="," property="sacFlag"> #sacFlag#  </isNotEmpty>
			<isNotEmpty prepend="," property="innConFlag"> #innConFlag#
			</isNotEmpty>
			<isNotEmpty prepend="," property="innConStatus"> #innConStatus#
			</isNotEmpty>
			<isNotEmpty prepend="," property="payconType"> #payconType#
			</isNotEmpty>
			<isNotEmpty prepend="," property="chaConFlag"> #chaConFlag#
			</isNotEmpty>
			<isNotEmpty prepend="," property="chaConStatus"> #chaConStatus#
			</isNotEmpty>
			<isNotEmpty prepend="," property="trxBatchNo"> #trxBatchNo#
			</isNotEmpty>
			<isNotEmpty prepend="," property="updateTime"> #updateTime#
			</isNotEmpty>
			<isNotEmpty prepend="," property="createTime"> #createTime#
			</isNotEmpty>
			<isNotEmpty prepend="," property="memo"> #memo#  </isNotEmpty>
			<isNotEmpty prepend="," property="trxErrDealType"> #trxErrDealType#
			</isNotEmpty>
			<isNotEmpty prepend="," property="exRate"> #exRate#  </isNotEmpty>
			<isNotEmpty prepend="," property="sacCurrency"> #sacCurrency#  </isNotEmpty>
			<isNotEmpty prepend="," property="sacAmount"> #sacAmount#  </isNotEmpty>
			<isNotEmpty prepend="," property="craccCardId"> #craccCardId#  </isNotEmpty>
			<isNotEmpty prepend="," property="draccCardId"> #draccCardId#  </isNotEmpty>
		</dynamic>
		)
	</insert>
	<select id="getSacOtrxInfo" resultMap="SacOtrxInfo">
		SELECT
		id,
		cus_bill_no,
		plat_bill_no,
		trx_serial_no,
		otrx_serial_no,
		etrx_serial_no,
		trx_state,
		cracc_cus_code,
		cracc_cus_type,
		<!-- cracc_identify_type, cracc_identify_code, -->
		cracc_no,
		cracc_name,
		cracc_node_code,
		cracc_bank_name,
		dracc_cus_code,
		dracc_cus_type,
		<!-- dracc_identify_type, dracc_identify_code, -->
		dracc_no,
		dracc_name,
		dracc_node_code,
		dracc_bank_name,
		pay_currency,
		pay_amount,
		buss_type,
		trx_type,
		pay_way,
		sac_flag,
		inn_con_flag,
		inn_con_status,
		paycon_type,
		cha_con_flag,
		cha_con_status,
		trx_batch_no,
		update_time,
		create_time,
		memo,
		trx_err_deal_type,
		ex_rate,
		sac_currency,
		sac_amount,
		cracc_cus_name,
		dracc_cus_name,
		reversal_status,
		account_status,
		tax_amount,
        channel_cost,
	    cus_charge,
	    trx_succ_time,
		transport_expenses,
		dracc_card_id,
		cracc_card_id
		FROM SAC_OTRX_INFO
		<dynamic prepend="WHERE">
			<isNotEmpty prepend="AND" property="id"> ID = #id# </isNotEmpty>
			<isNotEmpty prepend="AND" property="trxSerialNo"> trx_serial_no = #trxSerialNo#  </isNotEmpty>
		</dynamic>
	</select>
	<select id="listSacOtrxInfo" parameterClass="java.util.Map" resultMap="SacOtrxInfo">
		SELECT
		id,
		cus_bill_no,
		plat_bill_no,
		trx_serial_no,
		otrx_serial_no,
		etrx_serial_no,
		trx_state,
		cracc_cus_code,
		cracc_cus_type,
		<!-- cracc_identify_type, cracc_identify_code, -->
		cracc_no,
		cracc_name,
		cracc_node_code,
		cracc_bank_name,
		dracc_cus_code,
		dracc_cus_type,
		<!-- dracc_identify_type, dracc_identify_code, -->
		dracc_no,
		dracc_name,
		dracc_node_code,
		dracc_bank_name,
		pay_currency,
		pay_amount,
		buss_type,
		trx_type,
		pay_way,
		sac_flag,
		inn_con_flag,
		inn_con_status,
		paycon_type,
		cha_con_flag,
		cha_con_status,
		trx_batch_no,
		update_time,
		create_time,
		memo,
		trx_err_deal_type,
		ex_rate,
		sac_currency,
		sac_amount,
		cracc_cus_name,
		dracc_cus_name,
		reversal_status,
		account_status,
		tax_amount,
        channel_cost,
	    cus_charge,
	    trx_succ_time,
		transport_expenses,
		dracc_card_id,
		cracc_card_id
		FROM SAC_OTRX_INFO
		<dynamic prepend="WHERE">
			<isNotEmpty prepend="AND" property="id"> id = #id#  </isNotEmpty>
			<isNotEmpty prepend="AND" property="cusBillNo"> cus_bill_no =
				#cusBillNo#  </isNotEmpty>
			<isNotEmpty prepend="AND" property="platBillNo"> plat_bill_no =
				#platBillNo#  </isNotEmpty>
			<isNotEmpty prepend="AND" property="draccCardId"> dracc_card_id =
				#draccCardId#  </isNotEmpty>
			<isNotEmpty prepend="AND" property="craccCardId"> cracc_card_id =
				#craccCardId#  </isNotEmpty>
			<isNotEmpty prepend="AND" property="trxSerialNo"> trx_serial_no =
				#trxSerialNo#  </isNotEmpty>
			<isNotEmpty prepend="AND" property="otrxSerialNo"> otrx_serial_no =
				#otrxSerialNo#  </isNotEmpty>
			<isNotEmpty prepend="AND" property="etrxSerialNo"> etrx_serial_no =
				#etrxSerialNo#  </isNotEmpty>
			<isNotEmpty prepend="AND" property="trxState"> trx_state = #trxState#
			</isNotEmpty>
			<isNotEmpty prepend="AND" property="craccCusCode"> cracc_cus_code =
				#craccCusCode#  </isNotEmpty>
			<isNotEmpty prepend="AND" property="craccCusType"> cracc_cus_type =
				#craccCusType#  </isNotEmpty>
			<!-- <isNotEmpty prepend="AND" property="craccIdentifyType"> cracc_identify_type = #craccIdentifyType# </isNotEmpty> <isNotEmpty prepend="AND" property="craccIdentifyCode"> cracc_identify_code = #craccIdentifyCode# 
				</isNotEmpty> -->
			<isNotEmpty prepend="AND" property="craccNo"> cracc_no = #craccNo#
			</isNotEmpty>
			<isNotEmpty prepend="AND" property="craccName"> cracc_name =
				#craccName#  </isNotEmpty>
			<isNotEmpty prepend="AND" property="craccNodeCode"> cracc_node_code =
				#craccNodeCode#  </isNotEmpty>
			<isNotEmpty prepend="AND" property="craccBankName"> cracc_bank_name =
				#craccBankName#  </isNotEmpty>
			<isNotEmpty prepend="AND" property="draccCusCode"> dracc_cus_code =
				#draccCusCode#  </isNotEmpty>
			<isNotEmpty prepend="AND" property="draccCusType"> dracc_cus_type =
				#draccCusType#  </isNotEmpty>
			<!-- <isNotEmpty prepend="AND" property="draccIdentifyType"> dracc_identify_type = #draccIdentifyType# </isNotEmpty> <isNotEmpty prepend="AND" property="draccIdentifyCode"> dracc_identify_code = #draccIdentifyCode# 
				</isNotEmpty> -->
			<isNotEmpty prepend="AND" property="draccNo"> dracc_no = #draccNo#
			</isNotEmpty>
			<isNotEmpty prepend="AND" property="draccName"> dracc_name =
				#draccName#  </isNotEmpty>
			<isNotEmpty prepend="AND" property="draccNodeCode"> dracc_node_code =
				#draccNodeCode#  </isNotEmpty>
			<isNotEmpty prepend="AND" property="draccBankName"> dracc_bank_name =
				#draccBankName#  </isNotEmpty>
			<isNotEmpty prepend="AND" property="payCurrency"> pay_currency =
				#payCurrency#  </isNotEmpty>
			<isNotEmpty prepend="AND" property="payAmount"> pay_amount =
				#payAmount#  </isNotEmpty>
			<isNotEmpty prepend="AND" property="bussType"> buss_type = #bussType#
			</isNotEmpty>
			<isNotEmpty prepend="AND" property="trxType"> trx_type = #trxType#
			</isNotEmpty>
			<isNotEmpty prepend="AND" property="payWay"> pay_way = #payWay#
			</isNotEmpty>
			<isNotEmpty prepend="AND" property="sacFlag"> sac_flag = #sacFlag#
			</isNotEmpty>
			<isNotEmpty prepend="AND" property="innConFlag"> inn_con_flag =
				#innConFlag#  </isNotEmpty>
			<isNotEmpty prepend="AND" property="innConStatus"> inn_con_status =
				#innConStatus#  </isNotEmpty>
			<isNotEmpty prepend="AND" property="payconType"> paycon_type =
				#payconType#  </isNotEmpty>
			<isNotEmpty prepend="AND" property="chaConFlag"> cha_con_flag =
				#chaConFlag#  </isNotEmpty>
			<isNotEmpty prepend="AND" property="chaConStatus"> cha_con_status =
				#chaConStatus#  </isNotEmpty>
			<isNotEmpty prepend="AND" property="trxBatchNo"> trx_batch_no =
				#trxBatchNo#  </isNotEmpty>
			<isNotEmpty prepend="AND" property="updateTime"> update_time =
				#updateTime#  </isNotEmpty>
			<isNotEmpty prepend="AND" property="createTime"> create_time =
				#createTime#  </isNotEmpty>
			<isNotEmpty prepend="AND" property="memo"> memo = #memo#
			</isNotEmpty>
			<isNotEmpty prepend="AND" property="reversalStatus"> reversal_status = #reversalStatus#  </isNotEmpty>
			<isNotEmpty prepend="AND" property="accountStatus"> account_status = #accountStatus#  </isNotEmpty>
			<isNotEmpty prepend="AND" property="taxAmount"> tax_amount = #taxAmount#  </isNotEmpty>
			<isNotEmpty prepend="AND" property="transportExpenses"> transport_expenses = #transportExpenses#  </isNotEmpty>
			<isNotEmpty prepend="AND" property="trxErrDealType"> trx_err_deal_type =
				#trxErrDealType#  </isNotEmpty>
			<isNotEmpty prepend="AND" property="exRate"> ex_rate = #exRate#</isNotEmpty>
			<isNotEmpty prepend="AND" property="sacCurrency"> sac_currency = #sacCurrency#</isNotEmpty>
			<isNotEmpty prepend="AND" property="sacAmount"> sac_amount = #sacAmount#</isNotEmpty>
            <isNotEmpty prepend="AND" property="channelCost">  channel_cost = #channelCost#  </isNotEmpty>
            <isNotEmpty prepend="AND" property="cusCharge">  cus_charge = #cusCharge#  </isNotEmpty>
            <isNotEmpty prepend="AND" property="trxSuccTime">  trx_succ_time = #trxSuccTime#  </isNotEmpty>
			<isNotEmpty prepend="AND" property="cusNo" open="(" close=")">
				cracc_no = #cusNo# or dracc_no= #cusNo# </isNotEmpty>
			<isNotEmpty prepend="AND" property="payAmountStart"> 
				<![CDATA[ 
				pay_amount >= #payAmountStart# 
				]]>
			</isNotEmpty>
			<isNotEmpty prepend="AND" property="payAmountEnd">
				<![CDATA[ 
				pay_amount <=  #payAmountEnd#   
				]]>
			</isNotEmpty>
			<isNotEmpty prepend="AND" property="startDate"> 
				<![CDATA[ create_time >= to_date(#startDate#,'yyyyMMdd') ]]>
			</isNotEmpty>
			<isNotEmpty prepend="AND" property="endDate">
				<![CDATA[ create_time < to_date(#endDate#,'yyyyMMdd')+1   ]]>
			</isNotEmpty>
		</dynamic>
		<isEmpty prepend="ORDER BY" property="orderByFlag"> CREATE_TIME DESC
		</isEmpty>
		<isEqual prepend="ORDER BY" property="orderByFlag" compareValue="0"> CREATE_TIME DESC </isEqual>
		<isEqual prepend="ORDER BY" property="orderByFlag" compareValue="1"> CREATE_TIME ASC </isEqual>
	</select>
	<update id="updateSacOtrxInfo" parameterClass="net.easipay.cbp.model.SacOtrxInfo">
		UPDATE SAC_OTRX_INFO
		<dynamic prepend="SET">
			<isNotEmpty prepend="," property="cusBillNo"> cus_bill_no =
				#cusBillNo#  </isNotEmpty>
			<isNotEmpty prepend="," property="platBillNo"> plat_bill_no =
				#platBillNo#  </isNotEmpty>
			<isNotEmpty prepend="," property="draccCardId"> dracc_card_id =
				#draccCardId#  </isNotEmpty>
			<isNotEmpty prepend="," property="craccCardId"> cracc_card_id =
				#craccCardId#  </isNotEmpty>
			<isNotEmpty prepend="," property="trxSerialNo"> trx_serial_no =
				#trxSerialNo#  </isNotEmpty>
			<isNotEmpty prepend="," property="otrxSerialNo"> otrx_serial_no =
				#otrxSerialNo#  </isNotEmpty>
			<isNotEmpty prepend="," property="etrxSerialNo"> etrx_serial_no =
				#etrxSerialNo#  </isNotEmpty>
			<isNotEmpty prepend="," property="trxState"> trx_state = #trxState#
			</isNotEmpty>
			<isNotEmpty prepend="," property="craccCusCode"> cracc_cus_code =
				#craccCusCode#  </isNotEmpty>
			<isNotEmpty prepend="," property="craccCusType"> cracc_cus_type =
				#craccCusType#  </isNotEmpty>
			<!-- <isNotEmpty prepend="," property="craccIdentifyType"> cracc_identify_type = #craccIdentifyType# </isNotEmpty> <isNotEmpty prepend="," property="craccIdentifyCode"> cracc_identify_code = #craccIdentifyCode# 
				</isNotEmpty> -->
			<isNotEmpty prepend="," property="craccNo"> cracc_no = #craccNo#
			</isNotEmpty>
			<isNotEmpty prepend="," property="craccName"> cracc_name = #craccName#
			</isNotEmpty>
			<isNotEmpty prepend="," property="craccNodeCode"> cracc_node_code =
				#craccNodeCode#  </isNotEmpty>
			<isNotEmpty prepend="," property="craccBankName"> cracc_bank_name =
				#craccBankName#  </isNotEmpty>
			<isNotEmpty prepend="," property="draccCusCode"> dracc_cus_code =
				#draccCusCode#  </isNotEmpty>
			<isNotEmpty prepend="," property="draccCusType"> dracc_cus_type =
				#draccCusType#  </isNotEmpty>
			<!-- <isNotEmpty prepend="," property="draccIdentifyType"> dracc_identify_type = #draccIdentifyType# </isNotEmpty> <isNotEmpty prepend="," property="draccIdentifyCode"> dracc_identify_code = #draccIdentifyCode# 
				</isNotEmpty> -->
			<isNotEmpty prepend="," property="draccNo"> dracc_no = #draccNo#
			</isNotEmpty>
			<isNotEmpty prepend="," property="draccName"> dracc_name = #draccName#
			</isNotEmpty>
			<isNotEmpty prepend="," property="draccNodeCode"> dracc_node_code =
				#draccNodeCode#  </isNotEmpty>
			<isNotEmpty prepend="," property="draccBankName"> dracc_bank_name =
				#draccBankName#  </isNotEmpty>
			<isNotEmpty prepend="," property="payCurrency"> pay_currency =
				#payCurrency#  </isNotEmpty>
			<isNotEmpty prepend="," property="payAmount"> pay_amount = #payAmount#
			</isNotEmpty>
			<isNotEmpty prepend="," property="bussType"> buss_type = #bussType#
			</isNotEmpty>
			<isNotEmpty prepend="," property="trxType"> trx_type = #trxType#
			</isNotEmpty>
			<isNotEmpty prepend="," property="payWay"> pay_way = #payWay#
			</isNotEmpty>
			<isNotEmpty prepend="," property="sacFlag"> sac_flag = #sacFlag#
			</isNotEmpty>
			<isNotEmpty prepend="," property="innConFlag"> inn_con_flag =
				#innConFlag#  </isNotEmpty>
			<isNotEmpty prepend="," property="innConStatus"> inn_con_status =
				#innConStatus#  </isNotEmpty>
			<isNotEmpty prepend="," property="payconType"> paycon_type =
				#payconType#  </isNotEmpty>
			<isNotEmpty prepend="," property="chaConFlag"> cha_con_flag =
				#chaConFlag#  </isNotEmpty>
			<isNotEmpty prepend="," property="chaConStatus"> cha_con_status =
				#chaConStatus#  </isNotEmpty>
			<isNotEmpty prepend="," property="trxBatchNo"> trx_batch_no =
				#trxBatchNo#  </isNotEmpty>
			<isNotEmpty prepend="," property="updateTime"> update_time =
				#updateTime#  </isNotEmpty>
			<isNotEmpty prepend="," property="createTime"> create_time =
				#createTime#  </isNotEmpty>
			<isNotEmpty prepend="," property="memo"> memo = #memo#
			</isNotEmpty>
			<isNotEmpty prepend="," property="trxErrDealType"> trx_err_deal_type = #trxErrDealType#  </isNotEmpty>
			<isNotEmpty prepend="," property="exRate"> ex_rate = #exRate#</isNotEmpty>
			<isNotEmpty prepend="," property="sacCurrency"> sac_currency = #sacCurrency#</isNotEmpty>
			<isNotEmpty prepend="," property="sacAmount"> sac_amount = #sacAmount#</isNotEmpty>
            <isNotEmpty prepend="," property="channelCost">  channel_cost = #channelCost#  </isNotEmpty>
            <isNotEmpty prepend="," property="cusCharge">  cus_charge = #cusCharge#  </isNotEmpty>
            <isNotEmpty prepend="," property="trxSuccTime">  trx_succ_time = #trxSuccTime#  </isNotEmpty>
		</dynamic>
		WHERE ID = #id#
	</update>

	<update id="updateSacOtrxInfoBySerialNo" parameterClass="net.easipay.cbp.model.SacOtrxInfo">
		UPDATE SAC_OTRX_INFO
		<dynamic prepend="SET">
			<isNotEmpty prepend="," property="cusBillNo"> cus_bill_no =
				#cusBillNo#  </isNotEmpty>
			<isNotEmpty prepend="," property="platBillNo"> plat_bill_no =
				#platBillNo#  </isNotEmpty>
			<isNotEmpty prepend="," property="trxSerialNo"> trx_serial_no =
				#trxSerialNo#  </isNotEmpty>
			<isNotEmpty prepend="," property="otrxSerialNo"> otrx_serial_no =
				#otrxSerialNo#  </isNotEmpty>
			<isNotEmpty prepend="," property="etrxSerialNo"> etrx_serial_no =
				#etrxSerialNo#  </isNotEmpty>
			<isNotEmpty prepend="," property="trxState"> trx_state = #trxState#
			</isNotEmpty>
			<isNotEmpty prepend="," property="craccCusCode"> cracc_cus_code =
				#craccCusCode#  </isNotEmpty>
			<isNotEmpty prepend="," property="craccCusType"> cracc_cus_type =
				#craccCusType#  </isNotEmpty>
			<!-- <isNotEmpty prepend="," property="craccIdentifyType"> cracc_identify_type = #craccIdentifyType# </isNotEmpty> <isNotEmpty prepend="," property="craccIdentifyCode"> cracc_identify_code = #craccIdentifyCode# 
				</isNotEmpty> -->
			<isNotEmpty prepend="," property="craccNo"> cracc_no = #craccNo#
			</isNotEmpty>
			<isNotEmpty prepend="," property="craccName"> cracc_name = #craccName#
			</isNotEmpty>
			<isNotEmpty prepend="," property="craccNodeCode"> cracc_node_code =
				#craccNodeCode#  </isNotEmpty>
			<isNotEmpty prepend="," property="craccBankName"> cracc_bank_name =
				#craccBankName#  </isNotEmpty>
			<isNotEmpty prepend="," property="draccCusCode"> dracc_cus_code =
				#draccCusCode#  </isNotEmpty>
			<isNotEmpty prepend="," property="draccCusType"> dracc_cus_type =
				#draccCusType#  </isNotEmpty>
			<!-- <isNotEmpty prepend="," property="draccIdentifyType"> dracc_identify_type = #draccIdentifyType# </isNotEmpty> <isNotEmpty prepend="," property="draccIdentifyCode"> dracc_identify_code = #draccIdentifyCode# 
				</isNotEmpty> -->
			<isNotEmpty prepend="," property="draccNo"> dracc_no = #draccNo#
			</isNotEmpty>
			<isNotEmpty prepend="," property="draccName"> dracc_name = #draccName#
			</isNotEmpty>
			<isNotEmpty prepend="," property="draccNodeCode"> dracc_node_code =
				#draccNodeCode#  </isNotEmpty>
			<isNotEmpty prepend="," property="draccBankName"> dracc_bank_name =
				#draccBankName#  </isNotEmpty>
			<isNotEmpty prepend="," property="payCurrency"> pay_currency =
				#payCurrency#  </isNotEmpty>
			<isNotEmpty prepend="," property="payAmount"> pay_amount = #payAmount#
			</isNotEmpty>
			<isNotEmpty prepend="," property="bussType"> buss_type = #bussType#
			</isNotEmpty>
			<isNotEmpty prepend="," property="trxType"> trx_type = #trxType#
			</isNotEmpty>
			<isNotEmpty prepend="," property="payWay"> pay_way = #payWay#
			</isNotEmpty>
			<isNotEmpty prepend="," property="sacFlag"> sac_flag = #sacFlag#
			</isNotEmpty>
			<isNotEmpty prepend="," property="innConFlag"> inn_con_flag =
				#innConFlag#  </isNotEmpty>
			<isNotEmpty prepend="," property="innConStatus"> inn_con_status =
				#innConStatus#  </isNotEmpty>
			<isNotEmpty prepend="," property="payconType"> paycon_type =
				#payconType#  </isNotEmpty>
			<isNotEmpty prepend="," property="chaConFlag"> cha_con_flag =
				#chaConFlag#  </isNotEmpty>
			<isNotEmpty prepend="," property="chaConStatus"> cha_con_status =
				#chaConStatus#  </isNotEmpty>
			<isNotEmpty prepend="," property="trxBatchNo"> trx_batch_no =
				#trxBatchNo#  </isNotEmpty>
			<isNotEmpty prepend="," property="updateTime"> update_time =
				#updateTime#  </isNotEmpty>
			<isNotEmpty prepend="," property="createTime"> create_time =
				#createTime#  </isNotEmpty>
			<isNotEmpty prepend="," property="memo"> memo = #memo#
			</isNotEmpty>
			<isNotEmpty prepend="," property="trxErrDealType"> trx_err_deal_type = #trxErrDealType#  </isNotEmpty>
			<isNotEmpty prepend="," property="exRate"> ex_rate = #exRate#</isNotEmpty>
			<isNotEmpty prepend="," property="sacCurrency"> sac_currency = #sacCurrency#</isNotEmpty>
			<isNotEmpty prepend="," property="sacAmount"> sac_amount = #sacAmount#</isNotEmpty>
			<isNotEmpty prepend="," property="reversalStatus"> reversal_status = #reversalStatus#  </isNotEmpty>
			<isNotEmpty prepend="," property="accountStatus"> account_status = #accountStatus#  </isNotEmpty>
            <isNotEmpty prepend="," property="channelCost">  channel_cost = #channelCost#  </isNotEmpty>
            <isNotEmpty prepend="," property="cusCharge">  cus_charge = #cusCharge#  </isNotEmpty>
            <isNotEmpty prepend="," property="trxSuccTime">  trx_succ_time = #trxSuccTime#  </isNotEmpty>
		</dynamic>
		WHERE trx_serial_no = #trxSerialNo#
	</update>
	<delete id="deleteSacOtrxInfo">
		Delete
		from SAC_OTRX_INFO WHERE
		ID = #id#
  </delete>
	<delete id="deleteListSacOtrxInfo">
		Delete
		from SAC_OTRX_INFO
		WHERE ID IN ( $id$ )
  </delete>

	<select id="getSacOtrxInfoCount" resultClass="java.lang.Integer">
		SELECT COUNT(1) C FROM SAC_OTRX_INFO
		<dynamic prepend="WHERE">
			<isNotEmpty prepend="AND" property="id"> id = #id#  </isNotEmpty>
			<isNotEmpty prepend="AND" property="cusBillNo"> cus_bill_no =
				#cusBillNo#  </isNotEmpty>
			<isNotEmpty prepend="AND" property="platBillNo"> plat_bill_no =
				#platBillNo#  </isNotEmpty>
				<isNotEmpty prepend="AND" property="draccCardId"> dracc_card_id =
				#draccCardId#  </isNotEmpty>
			<isNotEmpty prepend="AND" property="craccCardId"> cracc_card_id =
				#craccCardId#  </isNotEmpty>
			<isNotEmpty prepend="AND" property="trxSerialNo"> trx_serial_no =
				#trxSerialNo#  </isNotEmpty>
			<isNotEmpty prepend="AND" property="otrxSerialNo"> otrx_serial_no =
				#otrxSerialNo#  </isNotEmpty>
			<isNotEmpty prepend="AND" property="etrxSerialNo"> etrx_serial_no =
				#etrxSerialNo#  </isNotEmpty>
			<isNotEmpty prepend="AND" property="trxState"> trx_state = #trxState#
			</isNotEmpty>
			<isNotEmpty prepend="AND" property="craccCusCode"> cracc_cus_code =
				#craccCusCode#  </isNotEmpty>
			<isNotEmpty prepend="AND" property="craccCusType"> cracc_cus_type =
				#craccCusType#  </isNotEmpty>
			<isNotEmpty prepend="AND" property="craccNo"> cracc_no = #craccNo#
			</isNotEmpty>
			<isNotEmpty prepend="AND" property="craccName"> cracc_name =
				#craccName#  </isNotEmpty>
			<isNotEmpty prepend="AND" property="craccNodeCode"> cracc_node_code =
				#craccNodeCode#  </isNotEmpty>
			<isNotEmpty prepend="AND" property="craccBankName"> cracc_bank_name =
				#craccBankName#  </isNotEmpty>
			<isNotEmpty prepend="AND" property="draccCusCode"> dracc_cus_code =
				#draccCusCode#  </isNotEmpty>
			<isNotEmpty prepend="AND" property="draccCusType"> dracc_cus_type =
				#draccCusType#  </isNotEmpty>
			<isNotEmpty prepend="AND" property="draccNo"> dracc_no = #draccNo#
			</isNotEmpty>
			<isNotEmpty prepend="AND" property="draccName"> dracc_name =
				#draccName#  </isNotEmpty>
			<isNotEmpty prepend="AND" property="draccNodeCode"> dracc_node_code =
				#draccNodeCode#  </isNotEmpty>
			<isNotEmpty prepend="AND" property="draccBankName"> dracc_bank_name =
				#draccBankName#  </isNotEmpty>
			<isNotEmpty prepend="AND" property="payCurrency"> pay_currency =
				#payCurrency#  </isNotEmpty>
			<isNotEmpty prepend="AND" property="payAmount"> pay_amount =
				#payAmount#  </isNotEmpty>
			<isNotEmpty prepend="AND" property="bussType"> buss_type = #bussType#
			</isNotEmpty>
			<isNotEmpty prepend="AND" property="trxType"> trx_type = #trxType#
			</isNotEmpty>
			<isNotEmpty prepend="AND" property="payWay"> pay_way = #payWay#
			</isNotEmpty>
			<isNotEmpty prepend="AND" property="sacFlag"> sac_flag = #sacFlag#
			</isNotEmpty>
			<isNotEmpty prepend="AND" property="innConFlag"> inn_con_flag =
				#innConFlag#  </isNotEmpty>
			<isNotEmpty prepend="AND" property="innConStatus"> inn_con_status =
				#innConStatus#  </isNotEmpty>
			<isNotEmpty prepend="AND" property="payconType"> paycon_type =
				#payconType#  </isNotEmpty>
			<isNotEmpty prepend="AND" property="chaConFlag"> cha_con_flag =
				#chaConFlag#  </isNotEmpty>
			<isNotEmpty prepend="AND" property="chaConStatus"> cha_con_status =
				#chaConStatus#  </isNotEmpty>
			<isNotEmpty prepend="AND" property="trxBatchNo"> trx_batch_no =
				#trxBatchNo#  </isNotEmpty>
			<isNotEmpty prepend="AND" property="updateTime"> update_time =
				#updateTime#  </isNotEmpty>
			<isNotEmpty prepend="AND" property="createTime"> <![CDATA[ create_time between  trunc(#createTime#,'dd') and TRUNC(#createTime#)+1-1/86400]]>
			</isNotEmpty>
			<isNotEmpty prepend="AND" property="memo"> memo = #memo#
			</isNotEmpty>
			<isNotEmpty prepend="AND" property="transType"> trx_type in ($transType$) </isNotEmpty>
			<isNotEmpty prepend="AND" property="reversalStatus"> reversal_status = #reversalStatus#  </isNotEmpty>
			<isNotEmpty prepend="AND" property="accountStatus"> account_status = #accountStatus#  </isNotEmpty>
			<isNotEmpty prepend="AND" property="taxAmount"> tax_amount = #taxAmount#  </isNotEmpty>
			<isNotEmpty prepend="AND" property="transportExpenses"> transport_expenses = #transportExpenses#  </isNotEmpty>
			<isNotEmpty prepend="AND" property="trxErrDealType"> trx_err_deal_type =
				#trxErrDealType#  </isNotEmpty>
			<isNotEmpty prepend="AND" property="exRate"> ex_rate = #exRate# </isNotEmpty>
			<isNotEmpty prepend="AND" property="sacCurrency"> sac_currency = #sacCurrency#</isNotEmpty>
			<isNotEmpty prepend="AND" property="sacAmount"> sac_amount = #sacAmount#</isNotEmpty>
            <isNotEmpty prepend="AND" property="channelCost">  channel_cost = #channelCost#  </isNotEmpty>
            <isNotEmpty prepend="AND" property="cusCharge">  cus_charge = #cusCharge#  </isNotEmpty>
            <isNotEmpty prepend="AND" property="trxSuccTime">  trx_succ_time = #trxSuccTime#  </isNotEmpty>
            <isNotEmpty prepend="AND" property="isNotFailue">  trx_state != #isNotFailue#  </isNotEmpty>
			<isNotEmpty prepend="AND" property="cusNo" open="(" close=")">
				cracc_cus_code like '%'||#cusNo#||'%' or dracc_cus_code like '%'||#cusNo#||'%'  </isNotEmpty>
			<isNotEmpty prepend="AND" property="payAmountStart"> 
				<![CDATA[ 
				pay_amount >= #payAmountStart# 
				]]>
			</isNotEmpty>
			<isNotEmpty prepend="AND" property="payAmountEnd">
				<![CDATA[ 
				pay_amount <=  #payAmountEnd#   
				]]>
			</isNotEmpty>
			<isNotEmpty prepend="AND" property="startDate"> 
				<![CDATA[ create_time >= to_date(#startDate#,'yyyyMMdd') ]]>
			</isNotEmpty>
			<isNotEmpty prepend="AND" property="endDate">
				<![CDATA[ create_time < to_date(#endDate#,'yyyyMMdd')+1   ]]>
			</isNotEmpty>
		</dynamic>
	</select>

	<select id="listSplitSacOtrxInfo" parameterClass="java.util.Map" resultMap="SacOtrxInfo">
		SELECT * FROM
		( SELECT A.*, ROWNUM R FROM
		( SELECT
		id,
		cus_bill_no,
		plat_bill_no,
		trx_serial_no,
		otrx_serial_no,
		etrx_serial_no,
		trx_state,
		cracc_cus_code,
		cracc_cus_type,
		<!-- cracc_identify_type, cracc_identify_code, -->
		cracc_no,
		cracc_name,
		cracc_node_code,
		cracc_bank_name,
		dracc_cus_code,
		dracc_cus_type,
		<!-- dracc_identify_type, dracc_identify_code, -->
		dracc_no,
		dracc_name,
		dracc_node_code,
		dracc_bank_name,
		pay_currency,
		pay_amount,
		buss_type,
		trx_type,
		pay_way,
		sac_flag,
		inn_con_flag,
		inn_con_status,
		paycon_type,
		cha_con_flag,
		cha_con_status,
		trx_batch_no,
		update_time,
		create_time,
		memo,
		trx_err_deal_type,
		ex_rate,
		sac_currency,
		sac_amount,
		cracc_cus_name,
		dracc_cus_name,
		reversal_status,
		account_status,
		tax_amount,
        channel_cost,
	    cus_charge,
	    trx_succ_time,
		transport_expenses,
		cracc_card_id,
		dracc_card_id
		from
		SAC_OTRX_INFO
		<dynamic prepend="WHERE">
			<isNotEmpty prepend="AND" property="id"> id = #id#  </isNotEmpty>
			<isNotEmpty prepend="AND" property="cusBillNo"> cus_bill_no =
				#cusBillNo#  </isNotEmpty>
			<isNotEmpty prepend="AND" property="platBillNo"> plat_bill_no =
				#platBillNo#  </isNotEmpty>
			<isNotEmpty prepend="AND" property="craccCardId"> cracc_card_id =
				#craccCardId#  </isNotEmpty>
			<isNotEmpty prepend="AND" property="draccCardId"> dracc_card_id =
				#draccCardId#  </isNotEmpty>
			<isNotEmpty prepend="AND" property="trxSerialNo"> trx_serial_no =
				#trxSerialNo#  </isNotEmpty>
			<isNotEmpty prepend="AND" property="otrxSerialNo"> otrx_serial_no =
				#otrxSerialNo#  </isNotEmpty>
			<isNotEmpty prepend="AND" property="etrxSerialNo"> etrx_serial_no =
				#etrxSerialNo#  </isNotEmpty>
			<isNotEmpty prepend="AND" property="trxState"> trx_state = #trxState#
			</isNotEmpty>
			<isNotEmpty prepend="AND" property="craccCusCode"> cracc_cus_code =
				#craccCusCode#  </isNotEmpty>
			<isNotEmpty prepend="AND" property="craccCusType"> cracc_cus_type =
				#craccCusType#  </isNotEmpty>
			<isNotEmpty prepend="AND" property="craccIdentifyType"> cracc_identify_type =
				#craccIdentifyType#  </isNotEmpty>
			<isNotEmpty prepend="AND" property="craccIdentifyCode"> cracc_identify_code =
				#craccIdentifyCode#  </isNotEmpty>
			<isNotEmpty prepend="AND" property="craccNo"> cracc_no = #craccNo#
			</isNotEmpty>
			<isNotEmpty prepend="AND" property="craccName"> cracc_name =
				#craccName#  </isNotEmpty>
			<isNotEmpty prepend="AND" property="craccNodeCode"> cracc_node_code =
				#craccNodeCode#  </isNotEmpty>
			<isNotEmpty prepend="AND" property="craccBankName"> cracc_bank_name =
				#craccBankName#  </isNotEmpty>
			<isNotEmpty prepend="AND" property="draccCusCode"> dracc_cus_code =
				#draccCusCode#  </isNotEmpty>
			<isNotEmpty prepend="AND" property="draccCusType"> dracc_cus_type =
				#draccCusType#  </isNotEmpty>
			<isNotEmpty prepend="AND" property="draccIdentifyType"> dracc_identify_type =
				#draccIdentifyType#  </isNotEmpty>
			<isNotEmpty prepend="AND" property="draccIdentifyCode"> dracc_identify_code =
				#draccIdentifyCode#  </isNotEmpty>
			<isNotEmpty prepend="AND" property="draccNo"> dracc_no = #draccNo#
			</isNotEmpty>
			<isNotEmpty prepend="AND" property="draccName"> dracc_name =
				#draccName#  </isNotEmpty>
			<isNotEmpty prepend="AND" property="draccNodeCode"> dracc_node_code =
				#draccNodeCode#  </isNotEmpty>
			<isNotEmpty prepend="AND" property="draccBankName"> dracc_bank_name =
				#draccBankName#  </isNotEmpty>
			<isNotEmpty prepend="AND" property="payCurrency"> pay_currency =
				#payCurrency#  </isNotEmpty>
			<isNotEmpty prepend="AND" property="payAmount"> pay_amount =
				#payAmount#  </isNotEmpty>
			<isNotEmpty prepend="AND" property="bussType"> buss_type = #bussType#
			</isNotEmpty>
			<isNotEmpty prepend="AND" property="trxType"> trx_type = #trxType#
			</isNotEmpty>
			<isNotEmpty prepend="AND" property="payWay"> pay_way = #payWay#
			</isNotEmpty>
			<isNotEmpty prepend="AND" property="sacFlag"> sac_flag = #sacFlag#
			</isNotEmpty>
			<isNotEmpty prepend="AND" property="innConFlag"> inn_con_flag =
				#innConFlag#  </isNotEmpty>
			<isNotEmpty prepend="AND" property="innConStatus"> inn_con_status =
				#innConStatus#  </isNotEmpty>
			<isNotEmpty prepend="AND" property="payconType"> paycon_type =
				#payconType#  </isNotEmpty>
			<isNotEmpty prepend="AND" property="chaConFlag"> cha_con_flag =
				#chaConFlag#  </isNotEmpty>
			<isNotEmpty prepend="AND" property="chaConStatus"> cha_con_status =
				#chaConStatus#  </isNotEmpty>
			<isNotEmpty prepend="AND" property="trxBatchNo"> trx_batch_no =
				#trxBatchNo#  </isNotEmpty>
			<isNotEmpty prepend="AND" property="updateTime"> update_time =
				#updateTime#  </isNotEmpty>
			<isNotEmpty prepend="AND" property="createTime"> <![CDATA[ create_time between  trunc(#createTime#,'dd') and TRUNC(#createTime#)+1-1/86400]]>
			</isNotEmpty>
			<isNotEmpty prepend="AND" property="memo"> memo = #memo#
			</isNotEmpty>
			<isNotEmpty prepend="AND" property="transType"> trx_type in ($transType$) </isNotEmpty>
			<isNotEmpty prepend="AND" property="reversalStatus"> reversal_status = #reversalStatus#  </isNotEmpty>
			<isNotEmpty prepend="AND" property="accountStatus"> account_status = #accountStatus#  </isNotEmpty>
			<isNotEmpty prepend="AND" property="taxAmount"> tax_amount = #taxAmount#  </isNotEmpty>
			<isNotEmpty prepend="AND" property="transportExpenses"> transport_expenses = #transportExpenses#  </isNotEmpty>
			<isNotEmpty prepend="AND" property="trxErrDealType"> trx_err_deal_type =
				#trxErrDealType#  </isNotEmpty>
			<isNotEmpty prepend="AND" property="exRate"> ex_rate = #exRate#</isNotEmpty>
			<isNotEmpty prepend="AND" property="sacCurrency"> sac_currency = #sacCurrency#</isNotEmpty>
			<isNotEmpty prepend="AND" property="sacAmount"> sac_amount = #sacAmount#</isNotEmpty>
            <isNotEmpty prepend="AND" property="channelCost">  channel_cost = #channelCost#  </isNotEmpty>
            <isNotEmpty prepend="AND" property="cusCharge">  cus_charge = #cusCharge#  </isNotEmpty>
            <isNotEmpty prepend="AND" property="trxSuccTime">  trx_succ_time = #trxSuccTime#  </isNotEmpty>
            <isNotEmpty prepend="AND" property="isNotFailue">  trx_state != #isNotFailue#  </isNotEmpty>
			<isNotEmpty prepend="AND" property="cusNo" open="(" close=")">
				cracc_no = #cusNo# or dracc_no= #cusNo# </isNotEmpty>
			<isNotEmpty prepend="AND" property="payAmountStart"> 
				<![CDATA[ 
				pay_amount >= #payAmountStart# 
				]]>
			</isNotEmpty>
			<isNotEmpty prepend="AND" property="payAmountEnd">
				<![CDATA[ 
				pay_amount <=  #payAmountEnd#   
				]]>
			</isNotEmpty>
			<isNotEmpty prepend="AND" property="startDate"> 
				<![CDATA[ create_time >= to_date(#startDate#,'yyyyMMdd') ]]>
			</isNotEmpty>
			<isNotEmpty prepend="AND" property="endDate">
				<![CDATA[ create_time < to_date(#endDate#,'yyyyMMdd')+1   ]]>
			</isNotEmpty>
		</dynamic>
		<isEmpty prepend="ORDER BY" property="orderByFlag"> create_time DESC
		</isEmpty>
		<isNotEmpty prepend="ORDER BY" property="orderByFlag"> $orderByFlag$
		</isNotEmpty>
		) A
		<![CDATA[
		WHERE ROWNUM <= #end# ) B
		WHERE R > #start#   
		]]>
	</select>

	<!-- 购汇结果查询 -->
	<select id="listSplitPayAndGetInfo" parameterClass="java.util.Map" resultMap="purchaseAndPay">
		SELECT * FROM
		( SELECT A.*, ROWNUM R FROM
		(select 
		    *
		 from v_sac_result
		 <dynamic prepend="where">
		 	<isNotEmpty prepend="AND" property="trxType"> trx_type = #trxType# </isNotEmpty>
		 	<isNotEmpty prepend="AND" property="draccCusCode"> cus_no like '%$draccCusCode$%' </isNotEmpty>
		 	<isNotEmpty prepend="AND" property="draccCusName"> cus_name like '%$draccCusName$%' </isNotEmpty>
			<isNotEmpty prepend="AND" property="draccNodeCode"> cracc_node_code = #draccNodeCode#  </isNotEmpty>
			<isNotEmpty prepend="AND" property="craccNodeCode"> cracc_node_code = #craccNodeCode#  </isNotEmpty>
			<isNotEmpty prepend="AND" property="payCurrency"> pay_currency = #payCurrency#  </isNotEmpty>
			<isNotEmpty prepend="AND" property="sacCurrency"> sac_currency = #sacCurrency#</isNotEmpty>
			<isNotEmpty prepend="AND" property="trxBatchNo"> trx_batch_no like '%$trxBatchNo$%'</isNotEmpty>
			<isNotEmpty prepend="AND" property="startDate"> <![CDATA[ trx_time >= to_date(#startDate#,'yyyyMMdd') ]]></isNotEmpty>
			<isNotEmpty prepend="AND" property="endDate"><![CDATA[ trx_time < to_date(#endDate#,'yyyyMMdd')+1 ]]></isNotEmpty>
		 </dynamic>
		) A
		<![CDATA[
		WHERE ROWNUM <= #end# ) B
		WHERE R > #start#   
		]]>
	</select>

	<!-- 购汇结果查询（不分页） -->
	<select id="listPayAndGetInfo" parameterClass="java.util.Map" resultMap="purchaseAndPay">
		 select 
		    *
		 from v_sac_result
		 <dynamic prepend="where">
		 	<isNotEmpty prepend="AND" property="trxType"> trx_type = #trxType# </isNotEmpty>
		 	<isNotEmpty prepend="AND" property="draccCusCode"> cus_no like '%$draccCusCode$%' </isNotEmpty>
		 	<isNotEmpty prepend="AND" property="draccCusName"> cus_name like '%$draccCusName$%' </isNotEmpty>
			<isNotEmpty prepend="AND" property="draccNodeCode"> cracc_node_code = #draccNodeCode#  </isNotEmpty>
			<isNotEmpty prepend="AND" property="craccNodeCode"> cracc_node_code = #craccNodeCode#  </isNotEmpty>
			<isNotEmpty prepend="AND" property="payCurrency"> pay_currency = #payCurrency#  </isNotEmpty>
			<isNotEmpty prepend="AND" property="sacCurrency"> sac_currency = #sacCurrency#</isNotEmpty>
			<isNotEmpty prepend="AND" property="trxBatchNo"> trx_batch_no like '%$trxBatchNo$%'</isNotEmpty>
			<isNotEmpty prepend="AND" property="startDate"> <![CDATA[ trx_time >= to_date(#startDate#,'yyyyMMdd') ]]></isNotEmpty>
			<isNotEmpty prepend="AND" property="endDate"><![CDATA[ trx_time < to_date(#endDate#,'yyyyMMdd')+1 ]]></isNotEmpty>
		 </dynamic>
	</select>

	<!-- 购汇总数查询 -->
	<select id="getPayAndGetInfoCount" resultClass="java.lang.Integer">
		SELECT COUNT(1) C FROM (
			select 
			    *
			 from v_sac_result
			 <dynamic prepend="where">
			 	<isNotEmpty prepend="AND" property="trxType"> trx_type = #trxType# </isNotEmpty>
			 	<isNotEmpty prepend="AND" property="draccCusCode"> cus_no like '%$draccCusCode$%' </isNotEmpty>
			 	<isNotEmpty prepend="AND" property="draccCusName"> cus_name like '%$draccCusName$%' </isNotEmpty>
				<isNotEmpty prepend="AND" property="draccNodeCode"> cracc_node_code = #draccNodeCode#  </isNotEmpty>
				<isNotEmpty prepend="AND" property="craccNodeCode"> cracc_node_code = #craccNodeCode#  </isNotEmpty>
				<isNotEmpty prepend="AND" property="payCurrency"> pay_currency = #payCurrency#  </isNotEmpty>
				<isNotEmpty prepend="AND" property="sacCurrency"> sac_currency = #sacCurrency#</isNotEmpty>
				<isNotEmpty prepend="AND" property="trxBatchNo"> trx_batch_no like '%$trxBatchNo$%'</isNotEmpty>
				<isNotEmpty prepend="AND" property="startDate"> <![CDATA[ trx_time >= to_date(#startDate#,'yyyyMMdd') ]]></isNotEmpty>
				<isNotEmpty prepend="AND" property="endDate"><![CDATA[ trx_time < to_date(#endDate#,'yyyyMMdd')+1 ]]></isNotEmpty>
			 </dynamic>
		)
	</select>
	
	
	<!-- 客户交易明细查询分页查询 -->
	<select id="newListSplitSacOtrxInfo" parameterClass="java.util.Map" resultMap="SacOtrxInfo2">
		SELECT * FROM
		( SELECT A.*, ROWNUM R
		FROM( 
		select
			id,
			cus_bill_no,
			plat_bill_no,
			trx_serial_no,
			otrx_serial_no,
			etrx_serial_no,
			trx_state,
			cracc_cus_code,
			cracc_cus_type,
			cracc_no,
			cracc_name,
			cracc_node_code,
			cracc_bank_name,
			dracc_cus_code,
			dracc_cus_type,
			dracc_no,
			dracc_name,
			dracc_node_code,
			dracc_bank_name,
			pay_currency,
			pay_amount,
			buss_type,
			trx_type,
			pay_way,
			sac_flag,
			inn_con_flag,
			inn_con_status,
			paycon_type,
			cha_con_flag,
			cha_con_status,
			trx_batch_no,
			update_time,
			create_time,
			memo,
			trx_err_deal_type,
			ex_rate,
			sac_currency,
			sac_amount,
			cracc_cus_name,
			dracc_cus_name,
	       	channel_cost,
		   	cus_charge,
		   	trx_succ_time
		FROM SAC_OTRX_INFO
		<dynamic prepend="WHERE">
			<isNotEmpty prepend="AND" property="cusBillNo"> cus_bill_no like '%$cusBillNo$%' </isNotEmpty>
			<isNotEmpty prepend="AND" property="trxSerialNo"> trx_serial_no like '%$trxSerialNo$%'  </isNotEmpty>
			<isNotEmpty prepend="AND" property="etrxSerialNo"> etrx_serial_no like '%$etrxSerialNo$%' </isNotEmpty>
			<isNotEmpty prepend="AND" property="platBillNo"> plat_bill_no like '%$platBillNo$%' </isNotEmpty>
			<isNotEmpty prepend="AND" property="bussType"> buss_type = #bussType# </isNotEmpty>
			<isNotEmpty prepend="AND" property="payCurrency"> pay_currency = #payCurrency#  </isNotEmpty>
			<isNotEmpty prepend="AND" property="sacCurrency"> sac_currency = #sacCurrency#  </isNotEmpty>
			<isNotEmpty prepend="AND" property="craccCusName"> cracc_cus_name like '%$craccCusName$%' </isNotEmpty>
			<isNotEmpty prepend="AND" property="craccBankName"> cracc_bank_name like '%$craccBankName$%' </isNotEmpty>
			<isNotEmpty prepend="AND" property="draccCusName"> dracc_cus_name like '%$draccCusName$%'  </isNotEmpty>
			<isNotEmpty prepend="AND" property="draccBankName"> dracc_bank_name like '%$draccBankName$%' </isNotEmpty>
			<isNotEmpty prepend="AND" property="trxType"> trx_type = #trxType# </isNotEmpty>
			<isNotEmpty prepend="AND" property="payconType"> paycon_type = #payconType#  </isNotEmpty>
			<isNotEmpty prepend="AND" property="payWay"> pay_way = #payWay# </isNotEmpty>
			<isNotEmpty prepend="AND" property="otrxSerialNo"> otrx_serial_no = #otrxSerialNo#  </isNotEmpty>
			<isNotEmpty prepend="AND" property="trxState"> trx_state = #trxState# </isNotEmpty>
			<isNotEmpty prepend="AND" property="craccCusCode"> cracc_cus_code = #craccCusCode#  </isNotEmpty>
			<isNotEmpty prepend="AND" property="craccCusType"> cracc_cus_type = #craccCusType#  </isNotEmpty>
			<isNotEmpty prepend="AND" property="craccNo"> cracc_no = #craccNo# </isNotEmpty>
			<isNotEmpty prepend="AND" property="craccNodeCode"> cracc_node_code = #craccNodeCode#  </isNotEmpty>
			<isNotEmpty prepend="AND" property="draccCusCode"> dracc_cus_code = #draccCusCode#  </isNotEmpty>
			<isNotEmpty prepend="AND" property="draccCusType"> dracc_cus_type = #draccCusType#  </isNotEmpty>
			<isNotEmpty prepend="AND" property="draccNo"> dracc_no = #draccNo# </isNotEmpty>
			<isNotEmpty prepend="AND" property="draccNodeCode"> dracc_node_code = #draccNodeCode#  </isNotEmpty>
			<isNotEmpty prepend="AND" property="payAmount"> pay_amount = #payAmount#  </isNotEmpty>
			<isNotEmpty prepend="AND" property="sacFlag"> sac_flag = #sacFlag# </isNotEmpty>
			<isNotEmpty prepend="AND" property="innConFlag"> inn_con_flag = #innConFlag#  </isNotEmpty>
			<isNotEmpty prepend="AND" property="innConStatus"> inn_con_status = #innConStatus#  </isNotEmpty>
			<isNotEmpty prepend="AND" property="chaConFlag"> cha_con_flag = #chaConFlag#  </isNotEmpty>
			<isNotEmpty prepend="AND" property="chaConStatus"> cha_con_status = #chaConStatus#  </isNotEmpty>
			<isNotEmpty prepend="AND" property="trxBatchNo"> trx_batch_no = #trxBatchNo#  </isNotEmpty>
			<isNotEmpty prepend="AND" property="updateTime"> update_time = #updateTime#  </isNotEmpty>
			<isNotEmpty prepend="AND" property="createTime"> create_time = #createTime#  </isNotEmpty>
			<isNotEmpty prepend="AND" property="memo"> memo = #memo# </isNotEmpty>
			<isNotEmpty prepend="AND" property="trxErrDealType"> trx_err_deal_type = #trxErrDealType#  </isNotEmpty>
			<isNotEmpty prepend="AND" property="exRate"> ex_rate = #exRate#</isNotEmpty>
			<isNotEmpty prepend="AND" property="sacCurrency"> sac_currency = #sacCurrency#</isNotEmpty>
			<isNotEmpty prepend="AND" property="sacAmount"> sac_amount = #sacAmount#</isNotEmpty>
			<isNotEmpty prepend="AND" property="payAmountStart"> 
				<![CDATA[ pay_amount >= #payAmountStart# ]]>
			</isNotEmpty>
			<isNotEmpty prepend="AND" property="payAmountEnd">
				<![CDATA[ pay_amount <=  #payAmountEnd#  ]]>
			</isNotEmpty>
			<isNotEmpty prepend="AND" property="startDate"> 
				<![CDATA[ create_time >= to_date(#startDate#,'yyyyMMdd') ]]>
			</isNotEmpty>
			<isNotEmpty prepend="AND" property="endDate">
				<![CDATA[ create_time < to_date(#endDate#,'yyyyMMdd')+1   ]]>
			</isNotEmpty>
			<isNotEmpty prepend="AND" property="trxSuccStartDate"> 
				<![CDATA[ trx_succ_time >= to_date(#trxSuccStartDate#,'yyyyMMdd') ]]>
			</isNotEmpty>
			<isNotEmpty prepend="AND" property="trxSuccEndDate">
				<![CDATA[ trx_succ_time < to_date(#trxSuccEndDate#,'yyyyMMdd')+1 ]]>
			</isNotEmpty>
			<isNotEmpty prepend="AND" property="trxTypeList">
				<![CDATA[ trx_type in ($trxTypeList$) ]]>
			</isNotEmpty>
		</dynamic>
		<isEmpty prepend="ORDER BY" property="orderByFlag"> CREATE_TIME DESC</isEmpty>
		) A
		<![CDATA[
		WHERE ROWNUM <= #end# ) B
		WHERE R > #start#   
		]]>
	</select>

	<!-- 查询客户交易明细不分页 -->
	<select id="newListSacOtrxInfo" parameterClass="java.util.Map" resultMap="SacOtrxInfo2">
		select
			id,
			cus_bill_no,
			plat_bill_no,
			trx_serial_no,
			otrx_serial_no,
			etrx_serial_no,
			trx_state,
			cracc_cus_code,
			cracc_cus_type,
			cracc_no,
			cracc_name,
			cracc_node_code,
			cracc_bank_name,
			dracc_cus_code,
			dracc_cus_type,
			dracc_no,
			dracc_name,
			dracc_node_code,
			dracc_bank_name,
			pay_currency,
			pay_amount,
			buss_type,
			trx_type,
			pay_way,
			sac_flag,
			inn_con_flag,
			inn_con_status,
			paycon_type,
			cha_con_flag,
			cha_con_status,
			trx_batch_no,
			update_time,
			create_time,
			memo,
			trx_err_deal_type,
			ex_rate,
			sac_currency,
			sac_amount,
			cracc_cus_name,
			dracc_cus_name,
	       	channel_cost,
		   	cus_charge,
		   	trx_succ_time
		FROM SAC_OTRX_INFO
		<dynamic prepend="WHERE">
			<isNotEmpty prepend="AND" property="cusBillNo"> cus_bill_no like '%$cusBillNo$%' </isNotEmpty>
			<isNotEmpty prepend="AND" property="trxSerialNo"> trx_serial_no like '%$trxSerialNo$%'  </isNotEmpty>
			<isNotEmpty prepend="AND" property="etrxSerialNo"> etrx_serial_no like '%$etrxSerialNo$%' </isNotEmpty>
			<isNotEmpty prepend="AND" property="platBillNo"> plat_bill_no like '%$platBillNo$%' </isNotEmpty>
			<isNotEmpty prepend="AND" property="bussType"> buss_type = #bussType# </isNotEmpty>
			<isNotEmpty prepend="AND" property="payCurrency"> pay_currency = #payCurrency#  </isNotEmpty>
			<isNotEmpty prepend="AND" property="craccCusName"> cracc_cus_name like '%$craccCusName$%' </isNotEmpty>
			<isNotEmpty prepend="AND" property="craccBankName"> cracc_bank_name like '%$craccBankName$%' </isNotEmpty>
			<isNotEmpty prepend="AND" property="draccCusName"> dracc_cus_name like '%$draccCusName$%'  </isNotEmpty>
			<isNotEmpty prepend="AND" property="draccBankName"> dracc_bank_name like '%$draccBankName$%' </isNotEmpty>
			<isNotEmpty prepend="AND" property="trxType"> trx_type = #trxType# </isNotEmpty>
			<isNotEmpty prepend="AND" property="payconType"> paycon_type = #payconType#  </isNotEmpty>
			<isNotEmpty prepend="AND" property="payWay"> pay_way = #payWay# </isNotEmpty>
			<isNotEmpty prepend="AND" property="otrxSerialNo"> otrx_serial_no = #otrxSerialNo#  </isNotEmpty>
			<isNotEmpty prepend="AND" property="trxState"> trx_state = #trxState# </isNotEmpty>
			<isNotEmpty prepend="AND" property="craccCusCode"> cracc_cus_code = #craccCusCode#  </isNotEmpty>
			<isNotEmpty prepend="AND" property="craccCusType"> cracc_cus_type = #craccCusType#  </isNotEmpty>
			<isNotEmpty prepend="AND" property="craccNo"> cracc_no = #craccNo# </isNotEmpty>
			<isNotEmpty prepend="AND" property="craccNodeCode"> cracc_node_code = #craccNodeCode#  </isNotEmpty>
			<isNotEmpty prepend="AND" property="draccCusCode"> dracc_cus_code = #draccCusCode#  </isNotEmpty>
			<isNotEmpty prepend="AND" property="draccCusType"> dracc_cus_type = #draccCusType#  </isNotEmpty>
			<isNotEmpty prepend="AND" property="draccNo"> dracc_no = #draccNo# </isNotEmpty>
			<isNotEmpty prepend="AND" property="draccNodeCode"> dracc_node_code = #draccNodeCode#  </isNotEmpty>
			<isNotEmpty prepend="AND" property="payAmount"> pay_amount = #payAmount#  </isNotEmpty>
			<isNotEmpty prepend="AND" property="sacFlag"> sac_flag = #sacFlag# </isNotEmpty>
			<isNotEmpty prepend="AND" property="innConFlag"> inn_con_flag = #innConFlag#  </isNotEmpty>
			<isNotEmpty prepend="AND" property="innConStatus"> inn_con_status = #innConStatus#  </isNotEmpty>
			<isNotEmpty prepend="AND" property="chaConFlag"> cha_con_flag = #chaConFlag#  </isNotEmpty>
			<isNotEmpty prepend="AND" property="chaConStatus"> cha_con_status = #chaConStatus#  </isNotEmpty>
			<isNotEmpty prepend="AND" property="trxBatchNo"> trx_batch_no = #trxBatchNo#  </isNotEmpty>
			<isNotEmpty prepend="AND" property="updateTime"> update_time = #updateTime#  </isNotEmpty>
			<isNotEmpty prepend="AND" property="createTime"> create_time = #createTime#  </isNotEmpty>
			<isNotEmpty prepend="AND" property="memo"> memo = #memo# </isNotEmpty>
			<isNotEmpty prepend="AND" property="trxErrDealType"> trx_err_deal_type = #trxErrDealType#  </isNotEmpty>
			<isNotEmpty prepend="AND" property="exRate"> ex_rate = #exRate#</isNotEmpty>
			<isNotEmpty prepend="AND" property="sacCurrency"> sac_currency = #sacCurrency#</isNotEmpty>
			<isNotEmpty prepend="AND" property="sacAmount"> sac_amount = #sacAmount#</isNotEmpty>
			<isNotEmpty prepend="AND" property="payAmountStart"> 
				<![CDATA[ pay_amount >= #payAmountStart# ]]>
			</isNotEmpty>
			<isNotEmpty prepend="AND" property="payAmountEnd">
				<![CDATA[ pay_amount <=  #payAmountEnd#  ]]>
			</isNotEmpty>
			<isNotEmpty prepend="AND" property="startDate"> 
				<![CDATA[ create_time >= to_date(#startDate#,'yyyyMMdd') ]]>
			</isNotEmpty>
			<isNotEmpty prepend="AND" property="endDate">
				<![CDATA[ create_time < to_date(#endDate#,'yyyyMMdd')+1   ]]>
			</isNotEmpty>
			<isNotEmpty prepend="AND" property="trxSuccStartDate"> 
				<![CDATA[ trx_succ_time >= to_date(#trxSuccStartDate#,'yyyyMMdd') ]]>
			</isNotEmpty>
			<isNotEmpty prepend="AND" property="trxSuccEndDate">
				<![CDATA[ trx_succ_time < to_date(#trxSuccEndDate#,'yyyyMMdd')+1 ]]>
			</isNotEmpty>
		</dynamic>
		<isEmpty prepend="ORDER BY" property="orderByFlag"> CREATE_TIME DESC</isEmpty>
	</select>
	
	<select id="newGetSacOtrxInfoCount" resultClass="java.lang.Integer">
		SELECT COUNT(1) C FROM SAC_OTRX_INFO
		<dynamic prepend="WHERE">
			<isNotEmpty prepend="AND" property="cusBillNo"> cus_bill_no like '%$cusBillNo$%' </isNotEmpty>
			<isNotEmpty prepend="AND" property="trxSerialNo"> trx_serial_no like '%$trxSerialNo$%'  </isNotEmpty>
			<isNotEmpty prepend="AND" property="etrxSerialNo"> etrx_serial_no like '%$etrxSerialNo$%' </isNotEmpty>
			<isNotEmpty prepend="AND" property="platBillNo"> plat_bill_no like '%$platBillNo$%' </isNotEmpty>
			<isNotEmpty prepend="AND" property="bussType"> buss_type = #bussType# </isNotEmpty>
			<isNotEmpty prepend="AND" property="payCurrency"> pay_currency = #payCurrency#  </isNotEmpty>
			<isNotEmpty prepend="AND" property="sacCurrency"> sac_currency = #sacCurrency#  </isNotEmpty>
			<isNotEmpty prepend="AND" property="craccCusName"> cracc_cus_name like '%$craccCusName$%' </isNotEmpty>
			<isNotEmpty prepend="AND" property="craccBankName"> cracc_bank_name like '%$craccBankName$%' </isNotEmpty>
			<isNotEmpty prepend="AND" property="draccCusName"> dracc_cus_name like '%$draccCusName$%'  </isNotEmpty>
			<isNotEmpty prepend="AND" property="draccBankName"> dracc_bank_name like '%$draccBankName$%' </isNotEmpty>
			<isNotEmpty prepend="AND" property="trxType"> trx_type = #trxType# </isNotEmpty>
			<isNotEmpty prepend="AND" property="payconType"> paycon_type = #payconType#  </isNotEmpty>
			<isNotEmpty prepend="AND" property="payWay"> pay_way = #payWay# </isNotEmpty>
			<isNotEmpty prepend="AND" property="otrxSerialNo"> otrx_serial_no = #otrxSerialNo#  </isNotEmpty>
			<isNotEmpty prepend="AND" property="trxState"> trx_state = #trxState# </isNotEmpty>
			<isNotEmpty prepend="AND" property="craccCusCode"> cracc_cus_code = #craccCusCode#  </isNotEmpty>
			<isNotEmpty prepend="AND" property="craccCusType"> cracc_cus_type = #craccCusType#  </isNotEmpty>
			<isNotEmpty prepend="AND" property="craccNo"> cracc_no = #craccNo# </isNotEmpty>
			<isNotEmpty prepend="AND" property="craccNodeCode"> cracc_node_code = #craccNodeCode#  </isNotEmpty>
			<isNotEmpty prepend="AND" property="draccCusCode"> dracc_cus_code = #draccCusCode#  </isNotEmpty>
			<isNotEmpty prepend="AND" property="draccCusType"> dracc_cus_type = #draccCusType#  </isNotEmpty>
			<isNotEmpty prepend="AND" property="draccNo"> dracc_no = #draccNo# </isNotEmpty>
			<isNotEmpty prepend="AND" property="draccNodeCode"> dracc_node_code = #draccNodeCode#  </isNotEmpty>
			<isNotEmpty prepend="AND" property="payAmount"> pay_amount = #payAmount#  </isNotEmpty>
			<isNotEmpty prepend="AND" property="sacFlag"> sac_flag = #sacFlag# </isNotEmpty>
			<isNotEmpty prepend="AND" property="innConFlag"> inn_con_flag = #innConFlag#  </isNotEmpty>
			<isNotEmpty prepend="AND" property="innConStatus"> inn_con_status = #innConStatus#  </isNotEmpty>
			<isNotEmpty prepend="AND" property="chaConFlag"> cha_con_flag = #chaConFlag#  </isNotEmpty>
			<isNotEmpty prepend="AND" property="chaConStatus"> cha_con_status = #chaConStatus#  </isNotEmpty>
			<isNotEmpty prepend="AND" property="trxBatchNo"> trx_batch_no = #trxBatchNo#  </isNotEmpty>
			<isNotEmpty prepend="AND" property="updateTime"> update_time = #updateTime#  </isNotEmpty>
			<isNotEmpty prepend="AND" property="createTime"> create_time = #createTime#  </isNotEmpty>
			<isNotEmpty prepend="AND" property="memo"> memo = #memo# </isNotEmpty>
			<isNotEmpty prepend="AND" property="trxErrDealType"> trx_err_deal_type = #trxErrDealType#  </isNotEmpty>
			<isNotEmpty prepend="AND" property="exRate"> ex_rate = #exRate#</isNotEmpty>
			<isNotEmpty prepend="AND" property="sacCurrency"> sac_currency = #sacCurrency#</isNotEmpty>
			<isNotEmpty prepend="AND" property="sacAmount"> sac_amount = #sacAmount#</isNotEmpty>
			<isNotEmpty prepend="AND" property="payAmountStart"> 
				<![CDATA[ pay_amount >= #payAmountStart# ]]>
			</isNotEmpty>
			<isNotEmpty prepend="AND" property="payAmountEnd">
				<![CDATA[ pay_amount <=  #payAmountEnd#  ]]>
			</isNotEmpty>
			<isNotEmpty prepend="AND" property="startDate"> 
				<![CDATA[ create_time >= to_date(#startDate#,'yyyyMMdd') ]]>
			</isNotEmpty>
			<isNotEmpty prepend="AND" property="endDate">
				<![CDATA[ create_time < to_date(#endDate#,'yyyyMMdd')+1   ]]>
			</isNotEmpty>
			<isNotEmpty prepend="AND" property="trxSuccStartDate"> 
				<![CDATA[ trx_succ_time >= to_date(#trxSuccStartDate#,'yyyyMMdd') ]]>
			</isNotEmpty>
			<isNotEmpty prepend="AND" property="trxSuccEndDate">
				<![CDATA[ trx_succ_time < to_date(#trxSuccEndDate#,'yyyyMMdd')+1 ]]>
			</isNotEmpty>
			<isNotEmpty prepend="AND" property="trxTypeList">
				<![CDATA[ trx_type in ($trxTypeList$) ]]>
			</isNotEmpty>
		</dynamic>
	</select>

	<!-- 查询客户交易明细,按币种统计 -->
	<select id="getAmountCount" parameterClass="java.util.Map" resultMap="AmountSum">
		select
			pay_currency,
			sum(pay_amount) as pay_amount_sum
		from SAC_OTRX_INFO
		<dynamic prepend="WHERE">
			<isNotEmpty prepend="AND" property="cusBillNo"> cus_bill_no like '%$cusBillNo$%' </isNotEmpty>
			<isNotEmpty prepend="AND" property="trxSerialNo"> trx_serial_no like '%$trxSerialNo$%'  </isNotEmpty>
			<isNotEmpty prepend="AND" property="etrxSerialNo"> etrx_serial_no like '%$etrxSerialNo$%' </isNotEmpty>
			<isNotEmpty prepend="AND" property="platBillNo"> plat_bill_no like '%$platBillNo$%' </isNotEmpty>
			<isNotEmpty prepend="AND" property="bussType"> buss_type = #bussType# </isNotEmpty>
			<isNotEmpty prepend="AND" property="payCurrency"> pay_currency = #payCurrency#  </isNotEmpty>
			<isNotEmpty prepend="AND" property="sacCurrency"> sac_currency = #sacCurrency#  </isNotEmpty>
			<isNotEmpty prepend="AND" property="craccCusName"> cracc_cus_name like '%$craccCusName$%' </isNotEmpty>
			<isNotEmpty prepend="AND" property="craccBankName"> cracc_bank_name like '%$craccBankName$%' </isNotEmpty>
			<isNotEmpty prepend="AND" property="draccCusName"> dracc_cus_name like '%$draccCusName$%'  </isNotEmpty>
			<isNotEmpty prepend="AND" property="draccBankName"> dracc_bank_name like '%$draccBankName$%' </isNotEmpty>
			<isNotEmpty prepend="AND" property="trxType"> trx_type = #trxType# </isNotEmpty>
			<isNotEmpty prepend="AND" property="payconType"> paycon_type = #payconType#  </isNotEmpty>
			<isNotEmpty prepend="AND" property="payWay"> pay_way = #payWay# </isNotEmpty>
			<isNotEmpty prepend="AND" property="otrxSerialNo"> otrx_serial_no = #otrxSerialNo#  </isNotEmpty>
			<isNotEmpty prepend="AND" property="trxState"> trx_state = #trxState# </isNotEmpty>
			<isNotEmpty prepend="AND" property="craccCusCode"> cracc_cus_code = #craccCusCode#  </isNotEmpty>
			<isNotEmpty prepend="AND" property="craccCusType"> cracc_cus_type = #craccCusType#  </isNotEmpty>
			<isNotEmpty prepend="AND" property="craccNo"> cracc_no = #craccNo# </isNotEmpty>
			<isNotEmpty prepend="AND" property="craccNodeCode"> cracc_node_code = #craccNodeCode#  </isNotEmpty>
			<isNotEmpty prepend="AND" property="draccCusCode"> dracc_cus_code = #draccCusCode#  </isNotEmpty>
			<isNotEmpty prepend="AND" property="draccCusType"> dracc_cus_type = #draccCusType#  </isNotEmpty>
			<isNotEmpty prepend="AND" property="draccNo"> dracc_no = #draccNo# </isNotEmpty>
			<isNotEmpty prepend="AND" property="draccNodeCode"> dracc_node_code = #draccNodeCode#  </isNotEmpty>
			<isNotEmpty prepend="AND" property="payAmount"> pay_amount = #payAmount#  </isNotEmpty>
			<isNotEmpty prepend="AND" property="sacFlag"> sac_flag = #sacFlag# </isNotEmpty>
			<isNotEmpty prepend="AND" property="innConFlag"> inn_con_flag = #innConFlag#  </isNotEmpty>
			<isNotEmpty prepend="AND" property="innConStatus"> inn_con_status = #innConStatus#  </isNotEmpty>
			<isNotEmpty prepend="AND" property="chaConFlag"> cha_con_flag = #chaConFlag#  </isNotEmpty>
			<isNotEmpty prepend="AND" property="chaConStatus"> cha_con_status = #chaConStatus#  </isNotEmpty>
			<isNotEmpty prepend="AND" property="trxBatchNo"> trx_batch_no = #trxBatchNo#  </isNotEmpty>
			<isNotEmpty prepend="AND" property="updateTime"> update_time = #updateTime#  </isNotEmpty>
			<isNotEmpty prepend="AND" property="createTime"> create_time = #createTime#  </isNotEmpty>
			<isNotEmpty prepend="AND" property="memo"> memo = #memo# </isNotEmpty>
			<isNotEmpty prepend="AND" property="trxErrDealType"> trx_err_deal_type = #trxErrDealType#  </isNotEmpty>
			<isNotEmpty prepend="AND" property="exRate"> ex_rate = #exRate#</isNotEmpty>
			<isNotEmpty prepend="AND" property="sacCurrency"> sac_currency = #sacCurrency#</isNotEmpty>
			<isNotEmpty prepend="AND" property="sacAmount"> sac_amount = #sacAmount#</isNotEmpty>
			<isNotEmpty prepend="AND" property="payAmountStart"> 
				<![CDATA[ pay_amount >= #payAmountStart# ]]>
			</isNotEmpty>
			<isNotEmpty prepend="AND" property="payAmountEnd">
				<![CDATA[ pay_amount <=  #payAmountEnd#  ]]>
			</isNotEmpty>
			<isNotEmpty prepend="AND" property="startDate"> 
				<![CDATA[ create_time >= to_date(#startDate#,'yyyyMMdd') ]]>
			</isNotEmpty>
			<isNotEmpty prepend="AND" property="endDate">
				<![CDATA[ create_time < to_date(#endDate#,'yyyyMMdd')+1   ]]>
			</isNotEmpty>
			<isNotEmpty prepend="AND" property="trxSuccStartDate"> 
				<![CDATA[ trx_succ_time >= to_date(#trxSuccStartDate#,'yyyyMMdd') ]]>
			</isNotEmpty>
			<isNotEmpty prepend="AND" property="trxSuccEndDate">
				<![CDATA[ trx_succ_time < to_date(#trxSuccEndDate#,'yyyyMMdd')+1 ]]>
			</isNotEmpty>
			<isNotEmpty prepend="AND" property="trxTypeList">
				<![CDATA[ trx_type in ($trxTypeList$) ]]>
			</isNotEmpty>
		</dynamic>
		group by pay_currency
	</select>
	
</sqlMap>
